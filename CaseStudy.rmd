#case study 1


```{r}
library(tidyverse)
library(VIM)
library(lattice)
library(DMwR)
library(mice)
library(ggplot2)
library(ggthemes)
```

```{r}
beers = read.csv("Beers.csv")
breweries = read.csv("Breweries.csv")
head(beers)
head(breweries)
```


#question 1: how many breweries are present in each state?

```{r}
state_breweries <- breweries %>%
  group_by(State) %>%
  tally() %>%
  arrange(desc(n))
head(state_breweries)
tail(state_breweries)
state_breweries %>%
  ggplot(aes(x=reorder(State, -n), y=n)) +
  geom_bar(stat = "identity") +
  ggtitle("Number of Breweries by State") +
  xlab("State") +
  ylab("Number of Breweries")
```

#question 2: merge data

```{r}
head(breweries)
head(beers)
beer_breweries = breweries %>%
  left_join(beers, by = c("Brew_ID" = "Brewery_id"))
names(beer_breweries) <- c("Brew_ID","Brewery Name","City","State","Beer Name", "Beer_ID","ABV","IBU","Style","Ounces")
head(beer_breweries)
```


#question 3: fix nas
```{r}

#plot the NAs
beer_breweries_miss = aggr(beer_breweries, col=mdc(1:2), numbers=TRUE, sortVars=TRUE, labels=names(beer_breweries), cex.axis=.7, gap=3, ylab=c("Proportion of NAs","NA Pattern"))

beer_breweries_impute <- knnImputation(beer_breweries)
beer_breweries <- beer_breweries_impute
```


#question 4: Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
```{r}
#median abv by state
state_abv = beer_breweries %>%
  group_by(State) %>%
  summarise(median = median(ABV, na.rm = TRUE))
head(state_abv)
state_abv %>%
  ggplot(aes(x=reorder(State, -median), y=median)) +
  geom_bar(stat = "identity") +
  ggtitle("Median ABV by State") +
  xlab("State") +
  ylab("Median ABV")

#median ibu by state
state_ibu = beer_breweries %>%
  group_by(State) %>%
  summarise(median = median(IBU, na.rm = TRUE))
head(state_ibu)
state_ibu %>%
  ggplot(aes(x=reorder(State, -median), y=median)) +
  geom_bar(stat = "identity") +
  ggtitle("Median IBU by State") +
  xlab("State") +
  ylab("Median IBU")
```



#question 5: Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r}
#CO has the beer with the highest ABV
top_ABV <- beer_breweries %>% 
  arrange(desc(ABV)) %>%
  top_n(10, ABV)
head(top_ABV[c("State", "Brewery Name", "Beer Name", "ABV")])

#OR has the beer with the highest IBU
top_IBU <- beer_breweries %>%
  arrange(desc(IBU)) %>%
  top_n(10, IBU)
head(top_IBU[c("State", "Brewery Name", "Beer Name", "IBU")])

```


#question 6: Comment on the summary statistics and distribution of the ABV variable.
The ABV ranges from .027 to .125, with a median of .057 and mean of .0599. The distribution looks somewhat right skewed.

```{r}
summary(beer_breweries$ABV)
beer_breweries %>%
  ggplot(aes(x=ABV)) +
  geom_histogram() +
  ggtitle("Histogram of ABV")
```


#question 7: Is there an apparent relationship between the bitterness of the beer and its alcoholic content?
```{r}
beer_breweries %>% ggplot(aes(x=ABV,y=IBU)) + theme_fivethirtyeight() + geom_point()+geom_smooth(method=lm) +
  xlab("Alcohol By Volume (ABV)") +
  ylab("International Bitterness Unit (IBU)") + ggtitle( "Relationship Between ABV and IBU")

cor(beer_breweries$ABV,beer_breweries$IBU)

# Judging by the scatterplot and the regression line there seems to be a positive correlation between ABV and IBU.  So that means there is a positive relationship betwen ABV and IBU so as ABV increases, so does IBU.


```

#question 9: freeform EDA--most common word used in beer names?