#case study 1


```{r}
library(tidyverse)
```

```{r}
beers = read.csv("Beers.csv")
breweries = read.csv("Breweries.csv")
head(beers)
head(breweries)
```


#question 1: how many breweries are present in each state?

```{r}
state_breweries <- breweries %>%
  group_by(State) %>%
  tally() %>%
  arrange(desc(n))
head(state_breweries)
tail(state_breweries)
state_breweries %>%
  ggplot(aes(x=reorder(State, -n), y=n)) +
  geom_bar(stat = "identity") +
  ggtitle("Number of Breweries by State") +
  xlab("State") +
  ylab("Number of Breweries")
```

#question 2: merge data

```{r}
head(breweries)
head(beers)
beer_breweries = breweries %>%
  left_join(beers, by = c("Brew_ID" = "Brewery_id"))
names(beer_breweries) <- c("Brew_ID","Brewery Name","City","State","Beer Name", "Beer_ID","ABV","IBU","Style","Ounces")
head(beer_breweries)
```


#question 3: fix nas
```{r}

n = colSums(is.na(beer_breweries))
n
mean(beer_breweries$ABV, na.rm = TRUE)
mean(beer_breweries$IBU, na.rm = TRUE)

beer_breweries$ABV[is.na(beer_breweries$ABV)] <- mean(beer_breweries$ABV, na.rm = TRUE)
beer_breweries$IBU[is.na(beer_breweries$IBU)] <- mean(beer_breweries$IBU, na.rm = TRUE)

colSums(is.na(beer_breweries))
```


#question 4: Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
```{r}
#median abv by state
state_abv = beer_breweries %>%
  group_by(State) %>%
  summarise(median = median(ABV, na.rm = TRUE))
head(state_abv)
state_abv %>%
  ggplot(aes(x=reorder(State, -median), y=median)) +
  geom_bar(stat = "identity") +
  ggtitle("Median ABV by State") +
  ggtitle("Median ABV by State") +
  xlab("State") +
  ylab("Median ABV")

#median ibu by state
state_ibu = beer_breweries %>%
  group_by(State) %>%
  summarise(median = median(IBU, na.rm = TRUE))
head(state_ibu)
state_ibu %>%
  ggplot(aes(x=reorder(State, -median), y=median)) +
  geom_bar(stat = "identity") +
  ggtitle("Median IBU by State") +
  ggtitle("Median ABV by State") +
  xlab("State") +
  ylab("Median IBU")
```



#question 5: Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r}
#KY has the beer with the highest ABV
top_ABV <- beer_breweries %>% 
  arrange(desc(ABV)) %>%
  top_n(10, ABV)
head(top_ABV[c("State", "Brewery Name", "Beer Name", "ABV")])

#OR has the beer with the highest IBU
top_IBU <- beer_breweries %>%
  arrange(desc(IBU)) %>%
  top_n(10, IBU)
head(top_IBU[c("State", "Brewery Name", "Beer Name", "IBU")])

```


#question 6: Comment on the summary statistics and distribution of the ABV variable.
The ABV ranges from .027 to .125, with a median of .057 and mean of .0599. The distribution looks somewhat right skewed.

```{r}
summary(beer_breweries$ABV)
beer_breweries %>%
  ggplot(aes(x=ABV)) +
  geom_histogram() +
  ggtitle("Histogram of ABV")
```


#question 8: IPA vs Other Ale
```{r}
summary(beer_breweries$Name.y)


```

#question 9: freeform EDA--most common word used in beer names?